<!DOCTYPE html>
<html>
<head>
    <title>up_file</title>
    <link rel="stylesheet" href="../Library/kindeditor/themes/default/default.css" />
    <script src="../Library/kindeditor/kindeditor-all.js"></script>
    <script src="../Static/js/jquery.js"></script>
    <!--<script  src="kindeditor/lang/zh-CN.js"></script>--> <!--默认中文-->
    <script>
    KindEditor.ready(function(K) {
        var editor = K.editor({
            fileManagerJson : '../Library/kindeditor/php/file_manager_json.php'
        });
        K('#filemanager').click(function() {
            editor.loadPlugin('filemanager', function() {
                editor.plugin.filemanagerDialog({
                    viewType : 'VIEW',
                    dirName : '',
                    clickFn : function(url, title) {
                        K('#url').val(url);
                        editor.hideDialog();
                    }
                });
            });
        });
    });
</script>

    <style>
        .load{ position: absolute; left:50%; top:50%; width:100px; height: 100px; background-color: rgba(0,0,0,0.5); margin-top: -50px; margin-left: -50px; display: none;}
        .load img{ display: block; margin: 30% auto;  line-height: 100px;}
    </style>
</head>
<body>
<a href="test.php?f=1.txt">文件下载</a>
<form action="test.php"  method="post" enctype="multipart/form-data">
<input type="file" name="file[]" value="" class="file"   multiple="multiple">  <span>本地上传允许一次上传多个文件</span>
<br/><!--<input type="text" id="url" value="" name="file_server"/> <input type="button" id="filemanager" value="服务器上传" />-->
<input type="submit" value="上传" onclick="check_file('.file',5,2,8,this)">
<div class="load">
    <img src="../Library/kindeditor/themes/common/loading.gif">
</div></form>
<script>
    function check_file(ele,n,max,files_max,t)
    {
        var file =$(ele).prop('files');
        var file_len=file.length;
        if(file_len>n)
        {
            alert("上传文件超过"+n+"个");
            return false;
        }
        // console.dir(file);
        var fileSize=0;
        var conut_size=0;
        for(var i=0;i<file_len;i++)
        {
            //console.log(file[i]);
            /*lastModified: 1505204874155
             lastModifiedDate: Tue Sep 12 2017 16:27:54 GMT+0800 (中国标准时间)
             name: "dede.txt"
             size: 22180
             type: "text/plain"
             * */
            fileSize=$(file)[i].size;
            if(fileSize>(2*1024*1024))
            {
                alert($(file)[i].name+'大于'+max+'MB');return false;
            }
            conut_size+=fileSize;
        }
        conut_size=conut_size/1024/1024;
        if(conut_size>8)
        {
            alert("总的上传文件大小"+conut_size.toFixed(2)+"大于"+files_max+"MB");
            return false;
        }else
        {
           if(file.length<1)return;
            $(".load").css("display","block");
            $(t).attr("type","submit");
        }
    }
</script>
</body>
</html>